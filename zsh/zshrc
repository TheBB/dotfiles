#!/usr/bin/zsh

unset GREP_OPTIONS

# ------------------------------------------------------------------------------------------
# Antigen bundles

if [[ ! -d ~/.antigen ]]
then
   git clone https://github.com/zsh-users/antigen.git ~/.antigen
fi

source ~/.antigen/antigen.zsh
antigen use oh-my-zsh

antigen bundle archlinux
antigen bundle colored-man-pages
antigen bundle fasd
antigen bundle git
antigen bundle virtualenv
antigen bundle virtualenvwrapper

antigen bundle djui/alias-tips
antigen bundle Vifon/deer
antigen bundle tarruda/zsh-autosuggestions
antigen bundle zsh-users/zsh-syntax-highlighting
antigen bundle zsh-users/zsh-history-substring-search

antigen apply

# ------------------------------------------------------------------------------------------
# This is an adapted version of the candy theme from oh-my-zsh

function bb_git_prompt() {
    local ref=$(git_prompt_info)
    if [[ -n $ref ]]; then
       echo "  $ref"
    fi
}

function bb_venv_prompt() {
    local ref=$(virtualenv_prompt_info)
    if [[ -n $ref ]]; then
        echo "  $ref"
    fi
}

PROMPT=$'%{$fg_bold[green]%}%n@%m  %{$fg[blue]%}%~%{$reset_color%}$(bb_git_prompt)$(bb_venv_prompt)\
%{$fg[blue]%}->%{$fg_bold[blue]%} %#%{$reset_color%} '
RPROMPT="%(?..%{$fg[red]%}%? ↵%{$reset_color%})"

ZSH_THEME_GIT_PROMPT_PREFIX="%{$fg_bold[yellow]%}"
ZSH_THEME_GIT_PROMPT_SUFFIX="%{$reset_color%}"
ZSH_THEME_GIT_PROMPT_DIRTY="(%{$fg[red]%}✘%{$fg[yellow]%})"
ZSH_THEME_GIT_PROMPT_CLEAN="(%{$fg[green]%}✔%{$fg[yellow]%})"
ZSH_THEME_VIRTUALENV_PREFIX="%{$fg_bold[cyan]%}"
ZSH_THEME_VIRTUALENV_SUFFIX="%{$reset_color%}"

# ------------------------------------------------------------------------------------------
# Miscellaneous

bindkey "$terminfo[kcuu1]" history-substring-search-up
bindkey "$terminfo[kcud1]" history-substring-search-down
bindkey "^k" autosuggest-clear
bindkey "^l" autosuggest-accept

ZSH_AUTOSUGGEST_CLEAR_WIDGETS+=(history-substring-search-up history-substring-search-down)

export TERM=xterm-256color
export EDITOR=ecli

alias sume="sudo -E su -m"
alias sudd="sudo -E"

source $HOME/.localzshrc
